<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebGL Triangle in Rust</title>
    <style>
        #canvas{
            /*width: 90vw;
            height: 90vh;*/
            /*width: 800px;
            height: 600px;*/
            margin-left: calc(50% - 600px);
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="1200" height="800"></canvas>
    <script type="module">
        import init, {Renderer} from "./pkg/rust_webgl.js";
        
        init().then(async () => {
            let renderer = new Renderer();

            renderer.load_shaders();
            await renderer.load_mesh();

            requestAnimationFrame(call_anim_frame);

            let mouseX = 0, mouseY = 0, mouseDown = false, mouseWheel = 0;
            document.addEventListener("wheel", (e) => mouseWheel = Math.sign(e.deltaY));
            document.addEventListener("mousedown", (e) => mouseDown = true);//TODO needs event
            document.addEventListener("mouseup", (e) => mouseDown = false);//TODO needs event
            document.addEventListener("mousemove", (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
            });

            function call_anim_frame() {
                renderer.update(mouseDown, mouseX, mouseY, mouseWheel);
                renderer.render();

                mouseWheel = 0;

                requestAnimationFrame(call_anim_frame);
            }
        }).catch((error) => {
            console.error("Initialization failed:", error);
        });
    </script>
</body>
</html>
